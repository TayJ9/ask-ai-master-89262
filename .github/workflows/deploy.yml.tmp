name: Deploy to Railway and Vercel

on:
  push:
    branches:
      - main
  workflow_dispatch:

jobs:
  # Railway auto-deploys from GitHub, so this is mainly for verification
  verify:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout code
        uses: actions/checkout@v4
      
      - name: Verify backend structure
        run: |
          echo "Verifying backend structure..."
          test -d backend && echo "âœ… Backend directory exists" || exit 1
          test -f backend/package.json && echo "âœ… Backend package.json exists" || exit 1
      
      - name: Verify frontend structure
        run: |
          echo "Verifying frontend structure..."
          test -d frontend && echo "âœ… Frontend directory exists" || exit 1
          test -f frontend/package.json && echo "âœ… Frontend package.json exists" || exit 1
      
      - name: Deployment info
        run: |
          echo "ğŸš€ Changes pushed to GitHub"
          echo "ğŸ“¦ Railway will auto-deploy backend from 'backend/' directory"
          echo "ğŸŒ Vercel will auto-deploy frontend from 'frontend/' directory"
          echo ""
          echo "Make sure:"
          echo "- Railway is connected to this repo with root directory: 'backend'"
          echo "- Vercel is connected to this repo with root directory: 'frontend'"
          echo "- NEXT_PUBLIC_API_URL is set in Vercel to your Railway backend URL"

